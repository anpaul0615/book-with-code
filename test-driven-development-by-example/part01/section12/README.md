# 12장 드디어, 더하기


## 메모

> ..어떻게 설계해야 할지 명백하지 않으면 다시 가짜 구현을 하고 리팩토링하는 식으로 접근할 것이다. 이를 통해 TDD를 하면서 어떻게 단계의 크기를 조절할 수 있는지 배우기 바란다.

> ..설계상 가장 어려운 제약은 다중 통화 사용에 대한 내용을 시스템의 나머지 코드에게 숨기고 싶다는 점이다.

> ..TDD는 적절한 때에 번뜩이는 통찰을 보장하지 못한다. 그렇지만 확신을 주는 테스트와 조심스럽게 정리된 코드를 통해, 통찰에 대한 준비와 함께, 통찰이 번뜩일 때 그걸 적용할 준비를 할 수 있다.

> ..왜 Bank 가 reduce 를 수행할 책임을 맡아야 하나? 한 가지 답은 "그게 제일 먼저 떠올랐다" 는 건데, 이건 별로 유익하지 않다. 왜 reduce 가 Expression 이 아닌 Bank 의 책임이어야 한다는 생각이 머리에 떠올랐을까?

> ..Expression 은 우리가 하려고 하는 일의 핵심에 해당한다. 나는 핵심이 되는 객체가 다른 부분에 대해서 될 수 있는 한 모르도록 노력한다. 그렇게 하면 핵심 객체가 가능한 오랫동안 유연할 수 있다. (게다가 테스트하기에 쉬울 뿐 아니라, 재활용하거나 이해하기에 모두 쉬운 상태로 남아 있을 수 있다)

> ..Expression 과 관련이 있는 오퍼레이션이 많을 거라고 상상할 수 있다. 만약에 모든 오퍼레이션을 Expression 에만 추가한다면 Expression 은 무한히 커질 것이다.

> ..이러한 생각들이 충분한 이유가 되지는 않겠지만, 당장 이렇게 진행하기로 결정하기엔 부족함이 없다. 또한 Bank 가 별 필요없게 된다면 reduce 를 구현할 책임을 Expression 으로 기꺼이 옮길 생각도 있다.

> 큰 테스트($5 + 10CHF)를 작은 테스트($5 + $5)로 줄여서 발전을 나타낼 수 있도록 했다.  
> 우리에게 필요한 계산(computation)에 대한 가능한 메타포들을 신중히 생각해봤다.  
> 새 메타포에 기반하여 기존의 테스트를 재작성했다.  
> 테스트를 빠르게 컴파일했다.  
> 그리고 테스트를 실행했다.  
> 진짜 구현을 만들기 위해 필요한 리팩토링을 약간의 전율과 함께 기대했다.  


## 코드 실습

- [Step 32 : 새로운 테스트 추가 ($5 + $5)](./step32.test.ts)
- [Step 33 : 테스트 대상코드 수정 (Expression 인터페이스, Bank 클래스, Bank.reduce, Money.plus 정의)](./step33.test.ts)


